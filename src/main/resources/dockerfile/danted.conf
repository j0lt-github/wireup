# Dante SOCKS5 Server Configuration for WireUp
# This configuration routes all SOCKS5 traffic through the WireGuard VPN tunnel

# Logging
logoutput: stderr

# Internal interface - listen for SOCKS5 connections from host
# Listen on all interfaces to ensure accessibility
internal: 0.0.0.0 port = 1080

# External interface - use wg0 for outbound connections
# This ensures traffic originates from the VPN interface
external: wg0

# Client authentication method - no authentication (container-internal only)
clientmethod: none

# SOCKS methods
socksmethod: none

# Client connection rules - allow connections from anywhere
client pass {
    from: 0.0.0.0/0 to: 0.0.0.0/0
    log: error
}

# Explicitly allow Docker subnets (redundant but safe)
client pass {
    from: 172.16.0.0/12 to: 0.0.0.0/0
    log: error
}
client pass {
    from: 10.0.0.0/8 to: 0.0.0.0/0
    log: error
}
client pass {
    from: 192.168.0.0/16 to: 0.0.0.0/0
    log: error
}
client pass {
    from: 127.0.0.0/8 to: 0.0.0.0/0
    log: error
}

# SOCKS pass rules - allow all outbound connections
# Traffic will be routed through WireGuard due to routing table rules
socks pass {
    from: 0.0.0.0/0 to: 0.0.0.0/0
    protocol: tcp udp
    log: error
}

# Block any other traffic
socks block {
    from: 0.0.0.0/0 to: 0.0.0.0/0
    log: error
}
